var ThisDB=function(u,i){i=i||"Api-Key";function a(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}var p="https://api.thisdb.com/v1/";this.createToken=function(e,t,n,o,r){r=r||function(){};var s={bucket:e,prefix:t,permissions:n,ttl:o};this.query("POST","tokens",s,r)},this.get=function(e,t,n){n=n||function(){},this.query("GET",e+"/"+t,"",n)},this.set=function(e,t,n,o){o=o||function(){},this.query("POST",e+"/"+t,n,o)},this.createBucket=function(e){e=e||function(){},this.query("POST","","",e)},this.listBucket=function(e,t,n){n=n||function(){};var o={format:t=t||"text"};this.query("GET",e,o,n)},this.updateBucket=function(e,t,n){n=n||function(){};var o={default_ttl:t};this.query("PATCH",e,o,n)},this.deleteBucket=function(e,t){t=t||function(){},this.query("DELETE",e,"",t)},this.query=function(e,t,n,o){var r,s=new XMLHttpRequest;switch(s.onreadystatechange=function(){if(4===s.readyState)switch(s.status){case 200:o(s.responseText);break;case 404:throw new ResourceNotFoundError(s.responseText);default:throw new Error(s.responseText)}},e){case"GET":var c=p+t+(""===(r=n)||void 0===r?"":"?"+Object.keys(r).map(function(e){return e+"="+encodeURIComponent(r[e])}).join("&"));s.open("GET",c,!0),s.setRequestHeader("X-"+i,u),s.send(null);break;case"POST":c=p+t;s.open("POST",c,!0),s.setRequestHeader("X-"+i,u),"object"==typeof n&&(n=a(n),s.setRequestHeader("Content-type","application/x-www-form-urlencoded")),s.send(n);break;case"PATCH":c=p+t;s.open("PATCH",c,!0),s.setRequestHeader("X-"+i,u),"object"==typeof n&&(n=a(n),s.setRequestHeader("Content-type","application/x-www-form-urlencoded")),s.send(n);break;case"DELETE":c=p+t;s.open("DELETE",c,!0),s.setRequestHeader("X-"+i,u),"object"==typeof n&&(n=a(n),s.setRequestHeader("Content-type","application/x-www-form-urlencoded")),s.send(n)}}};function ResourceNotFoundError(){var e=Error.apply(this,arguments);e.name=this.name="ResourceNotFoundError",this.message=e.message,Object.defineProperty?Object.defineProperty(this,"stack",{get:function(){return e.stack},configurable:!0}):this.stack=e.stack}ResourceNotFoundError.prototype=Object.create(Error.prototype,{constructor:{value:ResourceNotFoundError,writable:!0,configurable:!0}});