var ThisDB=function(c){var a=c.apiKey||"",f=c.token||"",p=c.defaultResponseFormat||"text",l="https://api.thisdb.com/v1/",d={};this.createToken=function(e,t){t=t||function(){};var n={bucket:e.bucket,prefix:e.prefix,permissions:e.permissions,ttl:e.ttl};this.query("POST","tokens",n,!1,t)},this.get=function(e,t){if(t=t||function(){},e.format)var n={format:e.format};else n="";this.query("GET",e.bucket+"/"+e.key,n,!1,t)},this.set=function(e,t){t=t||function(){},this.query("POST",e.bucket+"/"+e.key,e.value,!0,t)},this.increment=function(e,t){t=t||function(){},this.query("PATCH",e.bucket+"/"+e.key,e.value,!1,t)},this.delete=function(e,t){t=t||function(){},this.query("DELETE",e.bucket+"/"+e.key,"",!0,t)},this.createBucket=function(e,t){if(t=t||function(){},e.defaultTTL)var n={default_ttl:e.defaultTTL};else n="";this.query("POST","",n,!1,t)},this.listBucket=function(e,t){t=t||function(){};var n=e.bucket;if(delete e.bucket,isEmpty(e))r="";else var r=e;this.query("GET",n,r,!1,t)},this.updateBucket=function(e,t){if(t=t||function(){},e.defaultTTL)var n={default_ttl:e.defaultTTL};else n="";this.query("PATCH",e.bucket,n,!0,t)},this.deleteBucket=function(e,t){t=t||function(){},this.query("DELETE",e.bucket,"",!0,t)},this.query=function(e,t,n,r,o){var s,i=new XMLHttpRequest;switch(i.onreadystatechange=function(){i.readyState==i.HEADERS_RECEIVED&&i.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach(function(e){var t=e.split(": "),n=t.shift(),r=t.join(": ");d[n]=r});if(4===i.readyState){if(d["content-type"].includes("application/json"))var e=JSON.parse(i.responseText);else e=i.responseText;switch(i.status){case 200:o(!!r||e);break;case 404:throw new ResourceNotFoundError(e);default:throw new Error(e)}}},e){case"GET":var u=l+t+(""===(s=n)||void 0===s?"":"?"+Object.keys(s).map(function(e){return e+"="+encodeURIComponent(s[e])}).join("&"));i.open("GET",u,!0);break;case"POST":u=l+t;i.open("POST",u,!0);break;case"PATCH":u=l+t;i.open("PATCH",u,!0);break;case"DELETE":u=l+t;i.open("DELETE",u,!0)}c.apiKey?i.setRequestHeader("X-Api-Key",a):i.setRequestHeader("X-Token",f),"text"!==p&&"json"===p&&i.setRequestHeader("Accept","application/json"),"object"==typeof n&&(n=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}(n),i.setRequestHeader("Content-type","application/x-www-form-urlencoded")),"GET"===e?i.send(null):i.send(n)}};function isEmpty(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function ResourceNotFoundError(){var e=Error.apply(this,arguments);e.name=this.name="ResourceNotFoundError",this.message=e.message,Object.defineProperty?Object.defineProperty(this,"stack",{get:function(){return e.stack},configurable:!0}):this.stack=e.stack}ResourceNotFoundError.prototype=Object.create(Error.prototype,{constructor:{value:ResourceNotFoundError,writable:!0,configurable:!0}});