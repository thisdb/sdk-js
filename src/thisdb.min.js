var ThisDB=function(c,a){a=a||"Api-Key";function f(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}var p="https://api.thisdb.com/v1/";this.createToken=function(e,t,n,o,r){r=r||function(){};var s={bucket:e,prefix:t,permissions:n,ttl:o};this.query("POST","tokens",s,!1,r)},this.get=function(e,t,n){n=n||function(){},this.query("GET",e+"/"+t,"",!1,n)},this.set=function(e,t,n,o){o=o||function(){},this.query("POST",e+"/"+t,n,!0,o)},this.increment=function(e,t,n,o){o=o||function(){},this.query("PATCH",e+"/"+t,n,!1,o)},this.delete=function(e,t,n){n=n||function(){},this.query("DELETE",e+"/"+t,"",!0,n)},this.createBucket=function(e){e=e||function(){},this.query("POST","","",!1,e)},this.listBucket=function(e,t,n){n=n||function(){};var o={format:t=t||"text"};this.query("GET",e,o,!1,n)},this.updateBucket=function(e,t,n){n=n||function(){};var o={default_ttl:t};this.query("PATCH",e,o,!0,n)},this.deleteBucket=function(e,t){t=t||function(){},this.query("DELETE",e,"",!0,t)},this.query=function(e,t,n,o,r){var s,i=new XMLHttpRequest;switch(i.onreadystatechange=function(){if(4===i.readyState)switch(i.status){case 200:r(!!o||i.responseText);break;case 404:throw new ResourceNotFoundError(i.responseText);default:throw new Error(i.responseText)}},e){case"GET":var u=p+t+(""===(s=n)||void 0===s?"":"?"+Object.keys(s).map(function(e){return e+"="+encodeURIComponent(s[e])}).join("&"));i.open("GET",u,!0),i.setRequestHeader("X-"+a,c),i.send(null);break;case"POST":u=p+t;i.open("POST",u,!0),i.setRequestHeader("X-"+a,c),"object"==typeof n&&(n=f(n),i.setRequestHeader("Content-type","application/x-www-form-urlencoded")),i.send(n);break;case"PATCH":u=p+t;i.open("PATCH",u,!0),i.setRequestHeader("X-"+a,c),"object"==typeof n&&(n=f(n),i.setRequestHeader("Content-type","application/x-www-form-urlencoded")),i.send(n);break;case"DELETE":u=p+t;i.open("DELETE",u,!0),i.setRequestHeader("X-"+a,c),"object"==typeof n&&(n=f(n),i.setRequestHeader("Content-type","application/x-www-form-urlencoded")),i.send(n)}}};function ResourceNotFoundError(){var e=Error.apply(this,arguments);e.name=this.name="ResourceNotFoundError",this.message=e.message,Object.defineProperty?Object.defineProperty(this,"stack",{get:function(){return e.stack},configurable:!0}):this.stack=e.stack}ResourceNotFoundError.prototype=Object.create(Error.prototype,{constructor:{value:ResourceNotFoundError,writable:!0,configurable:!0}});